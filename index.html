<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>üå∏ Nail Sakura Studio</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò ========== */
        :root {
            /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
            --bg-primary: linear-gradient(135deg, #FFE4E9 0%, #FFB6C1 100%);
            --bg-secondary: rgba(255, 255, 255, 0.9);
            --bg-card: rgba(255, 255, 255, 0.92);
            --bg-overlay: rgba(255, 255, 255, 0.8);
            --text-primary: #5D1F31;
            --text-secondary: #8B475D;
            --text-muted: #A67A87;
            --accent-primary: #FFB6C1;
            --accent-secondary: #FF8FA3;
            --accent-danger: #E57373;
            --accent-warning: #FFB74D;
            --accent-success: #81C784;
            --accent-info: #64B5F6;
            --shadow: 0 8px 32px rgba(255, 182, 193, 0.25);
            --shadow-sm: 0 4px 16px rgba(255, 182, 193, 0.15);
            --shadow-lg: 0 16px 48px rgba(255, 182, 193, 0.35);
            --shadow-inset: inset 0 2px 8px rgba(255, 255, 255, 0.5);
            --border-radius: 24px;
            --border-radius-sm: 16px;
            --border-radius-lg: 32px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.2s ease;
            --transition-slow: all 0.5s ease;
        }

        /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ */
        [data-theme="dark"] {
            --bg-primary: linear-gradient(135deg, #5D1F31 0%, #2A2A2A 100%);
            --bg-secondary: rgba(45, 45, 45, 0.9);
            --bg-card: rgba(45, 45, 45, 0.92);
            --bg-overlay: rgba(0, 0, 0, 0.8);
            --text-primary: #FFE4E9;
            --text-secondary: #FFB6C1;
            --text-muted: #D4A7B5;
            --accent-primary: #8B475D;
            --accent-secondary: #D81B60;
            --accent-danger: #F44336;
            --accent-warning: #FF9800;
            --accent-success: #4CAF50;
            --accent-info: #2196F3;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --shadow-sm: 0 4px 16px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.4);
            --shadow-inset: inset 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        /* –†–æ–∑–æ–≤–∞—è —Ç–µ–º–∞ */
        [data-theme="pink"] {
            --bg-primary: linear-gradient(135deg, #FFB6C1 0%, #FF69B4 100%);
            --bg-secondary: rgba(255, 255, 255, 0.95);
            --bg-card: rgba(255, 255, 255, 0.95);
            --bg-overlay: rgba(255, 255, 255, 0.9);
            --text-primary: #8B0A50;
            --text-secondary: #FF1493;
            --text-muted: #FF69B4;
            --accent-primary: #FF69B4;
            --accent-secondary: #FF1493;
            --accent-danger: #FF416C;
            --accent-warning: #FFD166;
            --accent-success: #06D6A0;
            --accent-info: #118AB2;
            --shadow: 0 8px 32px rgba(255, 105, 180, 0.3);
            --shadow-sm: 0 4px 16px rgba(255, 105, 180, 0.2);
            --shadow-lg: 0 16px 48px rgba(255, 105, 180, 0.4);
            --shadow-inset: inset 0 2px 8px rgba(255, 255, 255, 0.6);
        }

        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 120px;
            transition: var(--transition-slow);
            overflow-x: hidden;
        }

        /* –£—Ç–∏–ª–∏—Ç—ã */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .gradient-text {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ========== –ê–ù–ò–ú–ê–¶–ò–ò ========== */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes slideInLeft {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px var(--accent-primary); }
            50% { box-shadow: 0 0 40px var(--accent-primary); }
        }

        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ========== –û–°–ù–û–í–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ ========== */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .screen.active {
            display: block;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            position: relative;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.6s ease;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            background-size: 200% auto;
            animation: shimmer 2s linear infinite;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            padding: 18px 24px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            text-decoration: none;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }

        .btn:active::after {
            animation: ripple 1s ease-out;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
            background-size: 150% auto;
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--accent-primary);
        }

        .btn-secondary:hover {
            background: rgba(255, 182, 193, 0.1);
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--accent-danger);
            color: white;
        }

        .btn-success {
            background: var(--accent-success);
            color: white;
        }

        .btn-warning {
            background: var(--accent-warning);
            color: white;
        }

        .btn-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            color: var(--accent-primary);
            font-size: 20px;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .btn-icon:hover {
            background: var(--accent-primary);
            color: white;
            transform: rotate(15deg) scale(1.1);
            box-shadow: var(--shadow);
        }

        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(255, 182, 193, 0.3);
            border-radius: var(--border-radius-sm);
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            font-size: 16px;
            transition: var(--transition);
            font-family: inherit;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(255, 182, 193, 0.2);
            background: rgba(255, 255, 255, 0.15);
        }

        /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ */
        .section-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), transparent);
        }

        /* ========== –®–ê–ü–ö–ê ========== */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--bg-card);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            animation: fadeInUp 0.4s ease;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 24px;
            font-weight: 700;
        }

        .logo-icon {
            animation: float 3s ease-in-out infinite;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            background: var(--bg-secondary);
            border-radius: 15px;
            border: none;
            cursor: pointer;
            box-shadow: var(--shadow-inset);
            transition: var(--transition);
        }

        .theme-toggle::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 50%;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        [data-theme="light"] .theme-toggle::after {
            content: '‚òÄÔ∏è';
        }

        [data-theme="dark"] .theme-toggle::after {
            content: 'üåô';
            transform: translateX(30px);
        }

        [data-theme="pink"] .theme-toggle::after {
            content: 'üå∏';
            transform: translateX(30px);
        }

        /* –ó–Ω–∞—á–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
        }

        /* ========== –ù–ò–ñ–ù–Ø–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø ========== */
        .bottom-nav {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 500px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 12px;
            box-shadow: var(--shadow-lg);
            display: flex;
            justify-content: space-around;
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeInUp 0.5s ease;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            border-radius: 12px;
            min-width: 60px;
        }

        .nav-item.active {
            background: rgba(255, 182, 193, 0.1);
            color: var(--accent-primary);
            transform: translateY(-5px);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
            transition: var(--transition);
        }

        .nav-item.active .nav-icon {
            transform: scale(1.2);
        }

        .nav-label {
            font-size: 11px;
            font-weight: 600;
        }

        /* ========== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ========== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-card);
            border-radius: var(--border-radius);
            padding: 16px 20px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 10000;
            animation: slideInRight 0.3s ease;
            max-width: 400px;
            border-left: 4px solid var(--accent-success);
            transform-origin: top right;
        }

        .notification.error { border-left-color: var(--accent-danger); }
        .notification.warning { border-left-color: var(--accent-warning); }
        .notification.info { border-left-color: var(--accent-info); }

        .notification-close {
            margin-left: auto;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 18px;
        }

        /* ========== –ó–ê–ì–†–£–ó–ß–ò–ö ========== */
        .loader {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 182, 193, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-primary);
            animation: spin 1s ease-in-out infinite;
        }

        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-overlay);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        /* ========== –°–¢–ê–¢–£–°–ù–´–ï –ë–ï–ô–î–ñ–ò ========== */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            gap: 6px;
            white-space: nowrap;
        }

        .status-pending {
            background: rgba(255, 193, 7, 0.1);
            color: var(--accent-warning);
        }

        .status-confirmed {
            background: rgba(76, 175, 80, 0.1);
            color: var(--accent-success);
        }

        .status-completed {
            background: rgba(33, 150, 243, 0.1);
            color: var(--accent-info);
        }

        .status-cancelled {
            background: rgba(244, 67, 54, 0.1);
            color: var(--accent-danger);
        }

        .status-paid {
            background: rgba(106, 27, 154, 0.1);
            color: #9C27B0;
        }

        /* ========== –ö–ê–†–¢–û–ß–ö–ò –£–°–õ–£–ì ========== */
        .service-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .service-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255, 182, 193, 0.1), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }

        .service-card:hover::before {
            transform: translateX(100%);
        }

        .service-card.selected {
            border-color: var(--accent-primary);
            background: rgba(255, 182, 193, 0.1);
            animation: glow 2s infinite;
        }

        .service-icon {
            font-size: 32px;
            margin-bottom: 10px;
            transition: var(--transition);
            display: block;
        }

        .service-card:hover .service-icon {
            transform: scale(1.2) rotate(10deg);
        }

        .service-popular {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--accent-primary);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
        }

        /* ========== –ì–ê–õ–ï–†–ï–Ø ========== */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .gallery-item {
            aspect-ratio: 1;
            background: var(--bg-secondary);
            border-radius: 16px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
            transition: var(--transition);
        }

        .gallery-item:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow);
        }

        /* ========== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-overlay);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.3s ease;
        }

        .modal {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.4s ease;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-muted);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .modal-close:hover {
            color: var(--accent-primary);
            transform: rotate(90deg);
        }

        /* ========== –ß–ê–¢ ========== */
        .chat-container {
            height: 400px;
            display: flex;
            flex-direction: column;
            background: var(--bg-card);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .chat-message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            position: relative;
            animation: fadeIn 0.3s ease;
        }

        .chat-message.user {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border-bottom-right-radius: 4px;
        }

        .chat-message.master {
            align-self: flex-start;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
        }

        .chat-message.system {
            align-self: center;
            background: var(--accent-info);
            color: white;
            font-size: 12px;
            padding: 8px 12px;
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
            padding: 15px;
            background: var(--bg-secondary);
            border-top: 1px solid rgba(255, 182, 193, 0.3);
        }

        /* ========== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ========== */
        @media (max-width: 480px) {
            body {
                padding: 15px;
                padding-bottom: 110px;
            }
            
            .container {
                padding: 0 5px;
            }
            
            .header {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            .service-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .section-title {
                font-size: 20px;
            }
            
            .card {
                padding: 20px;
            }
            
            .gallery-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .bottom-nav {
                width: 95%;
                padding: 10px;
            }
            
            .nav-item {
                padding: 6px 12px;
                min-width: 50px;
            }
            
            .modal {
                padding: 20px;
            }
        }

        @media (max-width: 360px) {
            .header-actions {
                gap: 5px;
            }
            
            .btn-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .theme-toggle {
                width: 50px;
                height: 25px;
            }
            
            .theme-toggle::after {
                width: 19px;
                height: 19px;
            }
        }

        /* ========== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –≠–§–§–ï–ö–¢–´ ========== */
        .particle {
            position: fixed;
            pointer-events: none;
            z-index: -1;
            font-size: 20px;
            animation: float linear infinite;
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            transform: scale(0);
            animation: ripple 0.6s linear;
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç —Å—Ç–µ–∫–ª–∞ */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* –ó—É–º –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        .hover-zoom {
            transition: transform 0.3s ease;
        }

        .hover-zoom:hover {
            transform: scale(1.05);
        }

        /* –ó–≤–µ–∑–¥—ã —Ä–µ–π—Ç–∏–Ω–≥–∞ */
        .stars {
            display: flex;
            gap: 2px;
            margin: 10px 0;
        }

        .star {
            font-size: 20px;
            color: #FFD700;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .star:hover {
            transform: scale(1.2);
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            padding: 15px;
            text-align: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-primary);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* –¢–∞–±–ª–∏—Ü—ã */
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 182, 193, 0.2);
        }

        .table th {
            font-weight: 600;
            color: var(--text-secondary);
            background: rgba(255, 182, 193, 0.1);
        }

        .table tr:hover {
            background: rgba(255, 182, 193, 0.05);
        }

        /* –ë–ª–æ–∫ —Å —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º–∏ */
        .payment-details {
            background: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-success);
        }

        /* –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ */
        .blacklist-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            margin-bottom: 10px;
            border-left: 4px solid var(--accent-danger);
        }
    </style>
</head>
<body>
    <!-- –ß–∞—Å—Ç–∏—Ü—ã —Ñ–æ–Ω–∞ -->
    <div id="particles"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="themeModal" class="modal-overlay hidden">
        <div class="modal">
            <button class="modal-close" onclick="closeModal('themeModal')">&times;</button>
            <h3 class="section-title">üé® –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É</h3>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0;">
                <button class="theme-option" onclick="setTheme('light')" data-theme="light" style="background: linear-gradient(135deg, #FFE4E9, #FFB6C1); padding: 20px; border-radius: var(--border-radius-sm); border: 3px solid transparent; cursor: pointer; transition: var(--transition);">
                    <div style="font-size: 32px;">‚òÄÔ∏è</div>
                    <div style="font-size: 14px; margin-top: 10px;">–°–≤–µ—Ç–ª–∞—è</div>
                </button>
                <button class="theme-option" onclick="setTheme('dark')" data-theme="dark" style="background: linear-gradient(135deg, #5D1F31, #2A2A2A); color: white; padding: 20px; border-radius: var(--border-radius-sm); border: 3px solid transparent; cursor: pointer; transition: var(--transition);">
                    <div style="font-size: 32px;">üåô</div>
                    <div style="font-size: 14px; margin-top: 10px;">–¢—ë–º–Ω–∞—è</div>
                </button>
                <button class="theme-option" onclick="setTheme('pink')" data-theme="pink" style="background: linear-gradient(135deg, #FFB6C1, #FF69B4); padding: 20px; border-radius: var(--border-radius-sm); border: 3px solid transparent; cursor: pointer; transition: var(--transition);">
                    <div style="font-size: 32px;">üå∏</div>
                    <div style="font-size: 14px; margin-top: 10px;">–†–æ–∑–æ–≤–∞—è</div>
                </button>
            </div>
        </div>
    </div>

    <div id="paymentModal" class="modal-overlay hidden">
        <div class="modal">
            <button class="modal-close" onclick="closeModal('paymentModal')">&times;</button>
            <h3 class="section-title">üí≥ –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞</h3>
            <div class="payment-details">
                <h4 style="margin-bottom: 15px;">–†–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã:</h4>
                <div style="margin-bottom: 15px;">
                    <div style="font-weight: 600; margin-bottom: 5px;">–°—É–º–º–∞ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã:</div>
                    <div style="font-size: 24px; color: var(--accent-primary); font-weight: bold;">200 ‚ÇΩ</div>
                </div>
                <div style="margin-bottom: 15px;">
                    <div style="font-weight: 600; margin-bottom: 5px;">–ë–∞–Ω–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª—è:</div>
                    <div style="background: rgba(255, 182, 193, 0.1); padding: 10px; border-radius: 8px; font-family: monospace; font-size: 14px;">
                        –¢–ò–ù–¨–ö–û–§–§ –ë–ê–ù–ö<br>
                        –°—á–µ—Ç: 4081 7801 2345 6789<br>
                        –ë–ò–ö: 044525974<br>
                        –ü–æ–ª—É—á–∞—Ç–µ–ª—å: –ò–ü –°–∞–∫—É—Ä–∞<br>
                        –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ –∑–∞ –º–∞–Ω–∏–∫—é—Ä
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <div style="font-weight: 600; margin-bottom: 5px;">–°–ë–ü (–ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞):</div>
                    <div style="background: rgba(255, 182, 193, 0.1); padding: 10px; border-radius: 8px; font-family: monospace; font-size: 14px;">
                        +7 (999) 123-45-67
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="confirmPayment" style="width: 20px; height: 20px;">
                        <span>–Ø –æ–ø–ª–∞—Ç–∏–ª –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É</span>
                    </label>
                </div>
            </div>
            <button class="btn btn-primary" onclick="confirmPayment()" style="margin-top: 20px;">
                <i class="fas fa-check"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É
            </button>
        </div>
    </div>

    <div id="reviewModal" class="modal-overlay hidden">
        <div class="modal">
            <button class="modal-close" onclick="closeModal('reviewModal')">&times;</button>
            <h3 class="section-title">‚≠ê –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
            <div class="form-group">
                <label class="form-label">–û—Ü–µ–Ω–∫–∞</label>
                <div class="stars" id="ratingStars">
                    <span class="star" data-rating="1">‚òÜ</span>
                    <span class="star" data-rating="2">‚òÜ</span>
                    <span class="star" data-rating="3">‚òÜ</span>
                    <span class="star" data-rating="4">‚òÜ</span>
                    <span class="star" data-rating="5">‚òÜ</span>
                </div>
                <div style="text-align: center; margin-top: 10px; font-size: 14px; color: var(--text-muted);" id="ratingText">
                    –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–≤–µ–∑–¥—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">–í–∞—à –æ—Ç–∑—ã–≤</label>
                <textarea class="form-textarea" id="reviewText" rows="4" placeholder="–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏ –æ –ø–æ—Å–µ—â–µ–Ω–∏–∏..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">–ú–∞—Å—Ç–µ—Ä</label>
                <select class="form-select" id="reviewMaster">
                    <option value="">–ù–µ —É–∫–∞–∑—ã–≤–∞—Ç—å</option>
                    <option>–ê–Ω–Ω–∞</option>
                    <option>–ú–∞—Ä–∏—è</option>
                    <option>–ï–ª–µ–Ω–∞</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="submitReview()">
                <i class="fas fa-paper-plane"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ—Ç–∑—ã–≤
            </button>
        </div>
    </div>

    <div id="adminModal" class="modal-overlay hidden">
        <div class="modal">
            <button class="modal-close" onclick="closeModal('adminModal')">&times;</button>
            <h3 class="section-title">üîê –í—Ö–æ–¥ –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
            <div class="form-group">
                <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                <input type="password" class="form-input" id="adminPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞">
            </div>
            <button class="btn btn-primary" onclick="loginAdmin()">
                <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏
            </button>
            <div style="margin-top: 20px; padding: 15px; background: rgba(255, 182, 193, 0.1); border-radius: var(--border-radius-sm);">
                <div style="font-weight: 600; margin-bottom: 10px;">–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:</div>
                <div style="font-size: 14px; color: var(--text-muted);">
                    ‚Ä¢ –ü–∞—Ä–æ–ª—å: <code>admin123</code><br>
                    ‚Ä¢ –î–ª—è –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞
                </div>
            </div>
        </div>
    </div>

    <div id="statisticsModal" class="modal-overlay hidden">
        <div class="modal">
            <button class="modal-close" onclick="closeModal('statisticsModal')">&times;</button>
            <h3 class="section-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∞–ª–æ–Ω–∞</h3>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalRevenue">0 ‚ÇΩ</div>
                    <div class="stat-label">–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalVisits">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgRating">0.0</div>
                    <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalReviews">0</div>
                    <div class="stat-label">–û—Ç–∑—ã–≤–æ–≤</div>
                </div>
            </div>

            <div style="margin: 20px 0;">
                <h4 style="margin-bottom: 15px;">üìà –î–æ—Ö–æ–¥ –ø–æ –º–µ—Å—è—Ü–∞–º</h4>
                <div id="revenueChart" style="height: 200px; background: var(--bg-secondary); border-radius: var(--border-radius-sm); padding: 20px; display: flex; align-items: flex-end; gap: 10px;">
                    <!-- –ì—Ä–∞—Ñ–∏–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>

            <div style="margin: 20px 0;">
                <h4 style="margin-bottom: 15px;">üë• –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏</h4>
                <div id="popularServices">
                    <!-- –°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ -->
                </div>
            </div>
        </div>
    </div>

    <div id="blacklistModal" class="modal-overlay hidden">
        <div class="modal">
            <button class="modal-close" onclick="closeModal('blacklistModal')">&times;</button>
            <h3 class="section-title">üö´ –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫</h3>
            
            <div class="form-group">
                <label class="form-label">–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫</label>
                <input type="text" class="form-input" id="blacklistName" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                <input type="text" class="form-input" id="blacklistPhone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" style="margin-top: 10px;">
                <textarea class="form-textarea" id="blacklistReason" rows="3" placeholder="–ü—Ä–∏—á–∏–Ω–∞" style="margin-top: 10px;"></textarea>
            </div>
            <button class="btn btn-danger" onclick="addToBlacklist()">
                <i class="fas fa-ban"></i> –î–æ–±–∞–≤–∏—Ç—å –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
            </button>

            <div style="margin-top: 30px;">
                <h4 style="margin-bottom: 15px;">–¢–µ–∫—É—â–∏–π —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫</h4>
                <div id="blacklistContent">
                    <!-- –°–ø–∏—Å–æ–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>

    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="loader-overlay hidden">
        <div class="loader"></div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notificationContainer"></div>

    <div class="container">
        <!-- –®–ê–ü–ö–ê -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">üå∏</span>
                <span class="gradient-text">Nail Sakura</span>
            </div>
            <div class="header-actions">
                <button class="btn-icon" onclick="toggleNotifications()" style="position: relative;">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationBadge"></span>
                </button>
                <button class="theme-toggle" onclick="openThemeModal()"></button>
            </div>
        </header>

        <!-- –≠–ö–†–ê–ù 1: –ì–õ–ê–í–ù–ê–Ø -->
        <div id="mainScreen" class="screen active">
            <div class="card" style="text-align: center;">
                <div id="userAvatar" style="width:100px;height:100px;background:linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));border-radius:50%;margin:0 auto 20px;display:flex;align-items:center;justify-content:center;font-size:40px;color:white;box-shadow: var(--shadow);">
                    üëë
                </div>
                <h2 id="userName" style="font-size:24px;margin-bottom:8px;font-weight:700;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
                <p id="userInfo" style="color:var(--text-secondary);margin-bottom:20px;font-size:14px;">Nail Sakura Studio</p>
                
                <div class="stats-grid" style="margin:20px 0;">
                    <div class="stat-card">
                        <div class="stat-value">‚≠ê 5.0</div>
                        <div class="stat-label">–í–∞—à —Ä–µ–π—Ç–∏–Ω–≥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">üé® 12</div>
                        <div class="stat-label">–ü–æ—Å–µ—â–µ–Ω–∏–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">üèÜ 850</div>
                        <div class="stat-label">–ë–∞–ª–ª–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">üíé Gold</div>
                        <div class="stat-label">–°—Ç–∞—Ç—É—Å</div>
                    </div>
                </div>
            </div>

            <div class="action-grid" style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:20px;">
                <button class="card hover-zoom" onclick="showScreen('booking')" style="text-align:center;padding:20px;cursor:pointer;border:none;background:var(--bg-card);">
                    <div style="font-size:32px;margin-bottom:10px;transition:transform 0.3s;">üíÖ</div>
                    <div style="font-weight:600;">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</div>
                </button>
                <button class="card hover-zoom" onclick="showScreen('services')" style="text-align:center;padding:20px;cursor:pointer;border:none;background:var(--bg-card);">
                    <div style="font-size:32px;margin-bottom:10px;transition:transform 0.3s;">‚ú®</div>
                    <div style="font-weight:600;">–£—Å–ª—É–≥–∏</div>
                </button>
                <button class="card hover-zoom" onclick="showScreen('chat')" style="text-align:center;padding:20px;cursor:pointer;border:none;background:var(--bg-card);">
                    <div style="font-size:32px;margin-bottom:10px;transition:transform 0.3s;">üí¨</div>
                    <div style="font-weight:600;">–ß–∞—Ç</div>
                </button>
                <button class="card hover-zoom" onclick="openStatisticsModal()" style="text-align:center;padding:20px;cursor:pointer;border:none;background:var(--bg-card);">
                    <div style="font-size:32px;margin-bottom:10px;transition:transform 0.3s;">üìä</div>
                    <div style="font-weight:600;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                </button>
            </div>

            <div class="card">
                <h3 class="section-title">
                    <i class="fas fa-clock"></i>
                    –ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–ø–∏—Å–∏
                </h3>
                <div id="upcomingBookings">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
            </div>

            <div class="card">
                <h3 class="section-title">
                    <i class="fas fa-star"></i>
                    –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã
                </h3>
                <div id="recentReviews">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
                <button class="btn btn-secondary" onclick="openReviewModal()" style="margin-top: 15px;">
                    <i class="fas fa-plus"></i> –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
                </button>
            </div>

            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="font-weight: 600;">‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É</h3>
                    <button class="btn btn-warning" onclick="openAdminModal()">
                        <i class="fas fa-cog"></i> –ü–∞–Ω–µ–ª—å
                    </button>
                </div>
                <div style="font-size: 14px; color: var(--text-muted);">
                    –î–æ—Å—Ç—É–ø –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ, —á–µ—Ä–Ω–æ–º—É —Å–ø–∏—Å–∫—É –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é
                </div>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 2: –ó–ê–ü–ò–°–¨ -->
        <div id="bookingScreen" class="screen">
            <div class="card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <button class="btn-icon" onclick="showScreen('main')">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h3 style="flex:1;text-align:center;font-weight:700;">üìù –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</h3>
                    <div style="width:50px;"></div>
                </div>

                <div class="form-group">
                    <label class="form-label">–£—Å–ª—É–≥–∞</label>
                    <select class="form-select" id="serviceSelect">
                        <option value="–ú–∞–Ω–∏–∫—é—Ä|1500">üíÖ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –º–∞–Ω–∏–∫—é—Ä - 1500‚ÇΩ</option>
                        <option value="–ì–µ–ª—å-–ª–∞–∫|2000">‚ú® –ü–æ–∫—Ä—ã—Ç–∏–µ –≥–µ–ª—å-–ª–∞–∫–æ–º - 2000‚ÇΩ</option>
                        <option value="–î–∏–∑–∞–π–Ω|1000">üé® –î–∏–∑–∞–π–Ω –Ω–æ–≥—Ç–µ–π - 1000‚ÇΩ</option>
                        <option value="SPA-—É—Ö–æ–¥|1800">üíé SPA-—É—Ö–æ–¥ - 1800‚ÇΩ</option>
                        <option value="–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ|2200">üõ°Ô∏è –£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –Ω–æ–≥—Ç–µ–π - 2200‚ÇΩ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏</label>
                    <input type="date" class="form-input" id="bookingDate">
                </div>

                <div class="form-group">
                    <label class="form-label">–í—Ä–µ–º—è</label>
                    <select class="form-select" id="bookingTime">
                        <option>10:00</option><option>11:00</option><option>12:00</option>
                        <option>13:00</option><option>14:00</option><option>15:00</option>
                        <option>16:00</option><option>17:00</option><option>18:00</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" class="form-input" id="clientPhone" placeholder="+7 (XXX) XXX-XX-XX" required>
                </div>

                <div class="form-group">
                    <label class="form-label">–ú–∞—Å—Ç–µ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                    <select class="form-select" id="bookingMaster">
                        <option value="">–õ—é–±–æ–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –º–∞—Å—Ç–µ—Ä</option>
                        <option>–ê–Ω–Ω–∞ (—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –¥–∏–∑–∞–π–Ω—É)</option>
                        <option>–ú–∞—Ä–∏—è (—ç–∫—Å–ø–µ—Ä—Ç –ø–æ SPA-—É—Ö–æ–¥—É)</option>
                        <option>–ï–ª–µ–Ω–∞ (–º–∞—Å—Ç–µ—Ä –ø—Ä–µ–º–∏—É–º-–∫–ª–∞—Å—Å–∞)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">–û—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è</label>
                    <textarea class="form-textarea" id="bookingNotes" rows="3" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ö–æ—á—É –¥–∏–∑–∞–π–Ω —Å —Ü–≤–µ—Ç–∞–º–∏ —Å–∞–∫—É—Ä—ã..."></textarea>
                </div>

                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
                        <input type="checkbox" id="prepaymentCheckbox" style="width:20px;height:20px;">
                        <span style="font-weight:600;">üí≥ –í–Ω–µ—Å—Ç–∏ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É 200‚ÇΩ</span>
                    </label>
                    <div style="font-size:12px;color:var(--text-muted);margin-top:5px;">
                        –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞—à—É –∑–∞–ø–∏—Å—å. –†–µ–∫–≤–∏–∑–∏—Ç—ã –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
                    </div>
                </div>

                <button class="btn btn-primary" onclick="submitBooking()">
                    <i class="fas fa-check"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–ø–∏—Å—å
                </button>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 3: –£–°–õ–£–ì–ò -->
        <div id="servicesScreen" class="screen">
            <div class="card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <button class="btn-icon" onclick="showScreen('main')">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h3 style="flex:1;text-align:center;font-weight:700;">üíÖ –ù–∞—à–∏ —É—Å–ª—É–≥–∏</h3>
                    <div style="width:50px;"></div>
                </div>

                <div class="service-grid">
                    <div class="service-card" onclick="selectService('manicure')">
                        <div class="service-icon">üíÖ</div>
                        <div style="font-weight:600;margin-bottom:5px;">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –º–∞–Ω–∏–∫—é—Ä</div>
                        <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;">–û–±—Ä–∞–±–æ—Ç–∫–∞ + –ø–æ–∫—Ä—ã—Ç–∏–µ –ª–∞–∫–æ–º</div>
                        <div style="font-weight:bold;color:var(--accent-primary);">1500‚ÇΩ ‚Ä¢ 90 –º–∏–Ω</div>
                    </div>
                    <div class="service-card" onclick="selectService('gel')">
                        <div class="service-icon">‚ú®</div>
                        <div style="font-weight:600;margin-bottom:5px;">–ì–µ–ª—å-–ª–∞–∫</div>
                        <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;">–î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ</div>
                        <div style="font-weight:bold;color:var(--accent-primary);">2000‚ÇΩ ‚Ä¢ 120 –º–∏–Ω</div>
                    </div>
                    <div class="service-card" onclick="selectService('design')">
                        <div class="service-icon">üé®</div>
                        <div style="font-weight:600;margin-bottom:5px;">–î–∏–∑–∞–π–Ω</div>
                        <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;">–†–∏—Å—É–Ω–∫–∏, —Å—Ç—Ä–∞–∑—ã, –≥—Ä–∞–¥–∏–µ–Ω—Ç</div>
                        <div style="font-weight:bold;color:var(--accent-primary);">1000‚ÇΩ ‚Ä¢ 60 –º–∏–Ω</div>
                    </div>
                    <div class="service-card" onclick="selectService('spa')">
                        <div class="service-icon">üíé</div>
                        <div style="font-weight:600;margin-bottom:5px;">SPA-—É—Ö–æ–¥</div>
                        <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;">–£–≤–ª–∞–∂–Ω–µ–Ω–∏–µ –∏ –ø–∏—Ç–∞–Ω–∏–µ</div>
                        <div style="font-weight:bold;color:var(--accent-primary);">1800‚ÇΩ ‚Ä¢ 75 –º–∏–Ω</div>
                    </div>
                </div>

                <div style="margin-top:30px;padding:20px;background:rgba(255,182,193,0.1);border-radius:var(--border-radius-sm);">
                    <h4 style="margin-bottom:10px;">üìù –ö–∞–∫ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è:</h4>
                    <ol style="padding-left:20px;font-size:14px;color:var(--text-muted);">
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</li>
                        <li>–£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è</li>
                        <li>–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã</li>
                        <li>–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–Ω–µ—Å–∏—Ç–µ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É</li>
                        <li>–ñ–¥–∏—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –º–∞—Å—Ç–µ—Ä–∞</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 4: –ß–ê–¢ -->
        <div id="chatScreen" class="screen">
            <div class="card" style="height:calc(100vh - 200px);display:flex;flex-direction:column;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <button class="btn-icon" onclick="showScreen('main')">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <div style="flex:1;text-align:center;">
                        <h3 style="font-weight:700;">üí¨ –ß–∞—Ç —Å –º–∞—Å—Ç–µ—Ä–æ–º</h3>
                        <div id="chatStatus" style="font-size:12px;color:var(--accent-success);">
                            <i class="fas fa-circle" style="font-size:8px;"></i> –û–Ω–ª–∞–π–Ω
                        </div>
                    </div>
                    <button class="btn-icon" onclick="refreshChat()">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>

                <div id="chatMessages" class="chat-messages">
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>

                <div class="chat-input-container">
                    <input type="text" id="chatInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="form-input" style="flex:1;border-radius:20px;">
                    <button class="btn-icon" onclick="sendMessage()" style="background:var(--accent-primary);color:white;">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 5: –ú–û–ò –ó–ê–ü–ò–°–ò -->
        <div id="myBookingsScreen" class="screen">
            <div class="card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <button class="btn-icon" onclick="showScreen('main')">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h3 style="flex:1;text-align:center;font-weight:700;">üìÖ –ú–æ–∏ –∑–∞–ø–∏—Å–∏</h3>
                    <button class="btn-icon" onclick="refreshBookings()">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>

                <div class="booking-filters" style="display:flex;gap:10px;margin-bottom:20px;">
                    <button class="filter-btn active" onclick="filterBookings('all')" style="padding:8px 16px;background:var(--accent-primary);color:white;border:none;border-radius:20px;font-size:14px;font-weight:600;cursor:pointer;">–í—Å–µ</button>
                    <button class="filter-btn" onclick="filterBookings('upcoming')" style="padding:8px 16px;background:var(--bg-secondary);color:var(--text-secondary);border:none;border-radius:20px;font-size:14px;font-weight:600;cursor:pointer;">–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ</button>
                    <button class="filter-btn" onclick="filterBookings('past')" style="padding:8px 16px;background:var(--bg-secondary);color:var(--text-secondary);border:none;border-radius:20px;font-size:14px;font-weight:600;cursor:pointer;">–ü—Ä–æ—à–ª—ã–µ</button>
                </div>

                <div id="bookingsList">
                    <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 6: –û–¢–ó–´–í–´ -->
        <div id="reviewsScreen" class="screen">
            <div class="card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <button class="btn-icon" onclick="showScreen('main')">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h3 style="flex:1;text-align:center;font-weight:700;">‚≠ê –û—Ç–∑—ã–≤—ã</h3>
                    <button class="btn-icon" onclick="openReviewModal()">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>

                <div id="allReviews">
                    <!-- –í—Å–µ –æ—Ç–∑—ã–≤—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="bottom-nav">
        <button class="nav-item active" onclick="showScreen('main')">
            <div class="nav-icon">üè†</div>
            <div class="nav-label">–ì–ª–∞–≤–Ω–∞—è</div>
        </button>
        <button class="nav-item" onclick="showScreen('booking')">
            <div class="nav-icon">üíÖ</div>
            <div class="nav-label">–ó–∞–ø–∏—Å—å</div>
        </button>
        <button class="nav-item" onclick="showScreen('services')">
            <div class="nav-icon">‚ú®</div>
            <div class="nav-label">–£—Å–ª—É–≥–∏</div>
        </button>
        <button class="nav-item" onclick="showScreen('myBookings')">
            <div class="nav-icon">üìÖ</div>
            <div class="nav-label">–ó–∞–ø–∏—Å–∏</div>
        </button>
        <button class="nav-item" onclick="showScreen('chat')">
            <div class="nav-icon">üí¨</div>
            <div class="nav-label">–ß–∞—Ç</div>
        </button>
    </nav>

<script>
// ================= –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø =================
const CONFIG = {
    MASTER_PASSWORD: "admin123",
    PREPAYMENT_AMOUNT: 200,
    APP_NAME: "Nail Sakura Studio",
    VERSION: "3.0.0"
};

// ================= –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =================
let currentUser = null;
let currentScreen = 'main';
let currentTheme = 'light';
let allBookings = [];
let allReviews = [];
let notifications = [];
let chatMessages = [];
let blacklist = [];
let statistics = {
    revenue: 0,
    visits: 0,
    avgRating: 0,
    totalReviews: 0,
    monthlyRevenue: {},
    popularServices: {}
};

// ================= –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =================
document.addEventListener('DOMContentLoaded', async function() {
    console.log(`üå∏ ${CONFIG.APP_NAME} v${CONFIG.VERSION}`);
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É
    const savedTheme = localStorage.getItem('nailSakuraTheme') || 'light';
    setTheme(savedTheme);
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    loadLocalData();
    createParticles();
    calculateStatistics();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
    if (window.Telegram && Telegram.WebApp) {
        initTelegram();
    } else {
        initGuestMode();
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
    updateUI();
    setupEventListeners();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º welcome —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    setTimeout(() => {
        showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Nail Sakura Studio! üå∏', 'info');
        updateNotificationBadge();
    }, 1000);
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
function initTelegram() {
    const tg = Telegram.WebApp;
    tg.expand();
    tg.setHeaderColor('#FFB6C1');
    tg.setBackgroundColor('#FFE4E9');
    tg.ready();
    
    const user = tg.initDataUnsafe?.user;
    if (user) {
        currentUser = {
            id: user.id,
            firstName: user.first_name,
            lastName: user.last_name || '',
            username: user.username,
            photoUrl: user.photo_url,
            isPremium: user.is_premium || false,
            languageCode: user.language_code || 'ru'
        };
        
        document.getElementById('userName').textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentUser.firstName}!`;
        
        if (currentUser.photoUrl) {
            document.getElementById('userAvatar').innerHTML = `<img src="${currentUser.photoUrl}" style="width:100%;height:100%;border-radius:50%;object-fit:cover;">`;
        }
    }
}

// –ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º
function initGuestMode() {
    currentUser = {
        id: 'guest_' + Math.random().toString(36).substr(2, 9),
        firstName: '–ì–æ—Å—Ç—å',
        lastName: '',
        username: '',
        photoUrl: '',
        isPremium: false
    };
    
    showNotification('–ó–∞–ø—É—â–µ–Ω–æ –≤ —Ä–µ–∂–∏–º–µ –±—Ä–∞—É–∑–µ—Ä–∞', 'warning');
}

// ================= –ù–ê–í–ò–ì–ê–¶–ò–Ø –ò –≠–ö–†–ê–ù–´ =================
function showScreen(screenName) {
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —ç–∫—Ä–∞–Ω
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenName + 'Screen').classList.add('active');
    currentScreen = screenName;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∏–∂–Ω—é—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é
    document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
    const screens = ['main', 'booking', 'services', 'myBookings', 'chat'];
    const index = screens.indexOf(screenName);
    if (index !== -1) {
        document.querySelectorAll('.nav-item')[index].classList.add('active');
    }
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç–∫—Ä–∞–Ω–∞
    switch(screenName) {
        case 'myBookings':
            loadUserBookings();
            break;
        case 'chat':
            loadChat();
            break;
        case 'reviews':
            loadAllReviews();
            break;
    }
}

// ================= –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£ =================
async function submitBooking() {
    const serviceSelect = document.getElementById('serviceSelect').value;
    const date = document.getElementById('bookingDate').value;
    const time = document.getElementById('bookingTime').value;
    const phone = document.getElementById('clientPhone').value;
    const master = document.getElementById('bookingMaster').value;
    const notes = document.getElementById('bookingNotes').value;
    const prepayment = document.getElementById('prepaymentCheckbox').checked;
    
    if (!date) {
        showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É!', 'warning');
        return;
    }
    
    if (!phone) {
        showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω!', 'warning');
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
    if (isInBlacklist(phone)) {
        showNotification('–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –∑–∞–ø–∏—Å—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞', 'error');
        return;
    }
    
    // –ü–∞—Ä—Å–∏–º —É—Å–ª—É–≥—É
    const [serviceName, servicePrice] = serviceSelect.split('|');
    
    const booking = {
        id: Date.now(),
        userId: currentUser.id,
        userName: `${currentUser.firstName} ${currentUser.lastName || ''}`.trim(),
        userInfo: currentUser.username ? `@${currentUser.username}` : `ID: ${currentUser.id}`,
        service: serviceName,
        price: parseInt(servicePrice),
        duration: getServiceDuration(serviceName),
        date: date,
        time: time,
        phone: phone,
        master: master || '',
        notes: notes || '',
        status: 'pending',
        prepayment: prepayment,
        prepaymentPaid: false,
        createdAt: new Date().toISOString()
    };
    
    // –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    if (prepayment) {
        showModal('paymentModal');
        window.currentBooking = booking;
        return;
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–ø–∏—Å—å
    saveBooking(booking);
}

function getServiceDuration(serviceName) {
    const durations = {
        '–ú–∞–Ω–∏–∫—é—Ä': 90,
        '–ì–µ–ª—å-–ª–∞–∫': 120,
        '–î–∏–∑–∞–π–Ω': 60,
        'SPA-—É—Ö–æ–¥': 75,
        '–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ': 120
    };
    return durations[serviceName] || 60;
}

function confirmPayment() {
    const confirmed = document.getElementById('confirmPayment').checked;
    if (!confirmed) {
        showNotification('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –æ–ø–ª–∞—Ç—É', 'warning');
        return;
    }
    
    if (window.currentBooking) {
        window.currentBooking.prepaymentPaid = true;
        saveBooking(window.currentBooking);
        closeModal('paymentModal');
        window.currentBooking = null;
    }
}

function saveBooking(booking) {
    showLoader();
    
    try {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
        allBookings.push(booking);
        saveLocalData();
        calculateStatistics();
        
        // –î–æ–±–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        addNotification(
            '–ó–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞', 
            `–í—ã –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ ${formatDate(booking.date)} –≤ ${booking.time}\n–£—Å–ª—É–≥–∞: ${booking.service}`,
            'success'
        );
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —á–∞—Ç
        const chatMsg = {
            id: Date.now(),
            text: `‚úÖ –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å: ${booking.service} –Ω–∞ ${formatDate(booking.date)} –≤ ${booking.time}`,
            sender: 'system',
            time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
        };
        chatMessages.push(chatMsg);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        setTimeout(() => {
            hideLoader();
            showNotification(
                booking.prepayment && booking.prepaymentPaid 
                    ? `üéâ –ó–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞! –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞.\n${booking.service}\n${formatDate(booking.date)} –≤ ${booking.time}`
                    : `üéâ –ó–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!\n${booking.service}\n${formatDate(booking.date)} –≤ ${booking.time}`,
                'success'
            );
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            resetBookingForm();
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
            showScreen('main');
        }, 1500);
        
    } catch (error) {
        hideLoader();
        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø–∏—Å–∏: ' + error.message, 'error');
    }
}

function resetBookingForm() {
    document.getElementById('bookingDate').value = '';
    document.getElementById('bookingTime').value = '10:00';
    document.getElementById('clientPhone').value = '';
    document.getElementById('bookingMaster').value = '';
    document.getElementById('bookingNotes').value = '';
    document.getElementById('prepaymentCheckbox').checked = false;
    document.getElementById('confirmPayment').checked = false;
}

// ================= –ß–ï–†–ù–´–ô –°–ü–ò–°–û–ö =================
function isInBlacklist(phone) {
    return blacklist.some(client => client.phone === phone);
}

function addToBlacklist() {
    const name = document.getElementById('blacklistName').value;
    const phone = document.getElementById('blacklistPhone').value;
    const reason = document.getElementById('blacklistReason').value;
    
    if (!name || !phone) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω', 'warning');
        return;
    }
    
    const client = {
        id: Date.now(),
        name: name,
        phone: phone,
        reason: reason || '–ù–µ —É–∫–∞–∑–∞–Ω–∞',
        addedAt: new Date().toISOString(),
        addedBy: currentUser.firstName
    };
    
    blacklist.push(client);
    saveLocalData();
    
    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
    document.getElementById('blacklistName').value = '';
    document.getElementById('blacklistPhone').value = '';
    document.getElementById('blacklistReason').value = '';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
    updateBlacklist();
    
    showNotification('–ö–ª–∏–µ–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫', 'success');
}

function updateBlacklist() {
    const container = document.getElementById('blacklistContent');
    if (!container) return;
    
    if (blacklist.length === 0) {
        container.innerHTML = '<div style="text-align:center;padding:20px;color:var(--text-muted);">–ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç</div>';
        return;
    }
    
    container.innerHTML = blacklist.map(client => `
        <div class="blacklist-item">
            <div>
                <div style="font-weight:600;">${client.name}</div>
                <div style="font-size:12px;color:var(--text-muted);">üìû ${client.phone}</div>
                <div style="font-size:12px;color:var(--accent-danger);margin-top:5px;">${client.reason}</div>
            </div>
            <button class="btn-icon" onclick="removeFromBlacklist(${client.id})" style="background:var(--accent-danger);">
                <i class="fas fa-times"></i>
            </button>
        </div>
    `).join('');
}

function removeFromBlacklist(id) {
    if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞?')) {
        blacklist = blacklist.filter(client => client.id !== id);
        saveLocalData();
        updateBlacklist();
        showNotification('–ö–ª–∏–µ–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞', 'success');
    }
}

// ================= –û–¢–ó–´–í–´ =================
let selectedRating = 0;

function setupRatingStars() {
    const stars = document.querySelectorAll('.star');
    stars.forEach(star => {
        star.addEventListener('click', function() {
            selectedRating = parseInt(this.dataset.rating);
            updateStarsDisplay();
        });
        
        star.addEventListener('mouseover', function() {
            const rating = parseInt(this.dataset.rating);
            stars.forEach((s, index) => {
                s.textContent = index < rating ? '‚òÖ' : '‚òÜ';
            });
        });
        
        star.addEventListener('mouseout', function() {
            updateStarsDisplay();
        });
    });
}

function updateStarsDisplay() {
    const stars = document.querySelectorAll('.star');
    const ratingText = document.getElementById('ratingText');
    
    stars.forEach((star, index) => {
        star.textContent = index < selectedRating ? '‚òÖ' : '‚òÜ';
    });
    
    const texts = [
        '–û—á–µ–Ω—å –ø–ª–æ—Ö–æ',
        '–ü–ª–æ—Ö–æ',
        '–ù–æ—Ä–º–∞–ª—å–Ω–æ',
        '–•–æ—Ä–æ—à–æ',
        '–û—Ç–ª–∏—á–Ω–æ!'
    ];
    
    ratingText.textContent = selectedRating > 0 ? texts[selectedRating - 1] : '–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–≤–µ–∑–¥—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏';
}

function submitReview() {
    const text = document.getElementById('reviewText').value;
    const master = document.getElementById('reviewMaster').value;
    
    if (selectedRating === 0) {
        showNotification('–ü–æ—Å—Ç–∞–≤—å—Ç–µ –æ—Ü–µ–Ω–∫—É', 'warning');
        return;
    }
    
    if (!text.trim()) {
        showNotification('–ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–∑—ã–≤', 'warning');
        return;
    }
    
    const review = {
        id: Date.now(),
        userId: currentUser.id,
        userName: currentUser.firstName,
        rating: selectedRating,
        text: text,
        master: master || '',
        date: new Date().toISOString(),
        likes: 0,
        replies: []
    };
    
    allReviews.unshift(review);
    saveLocalData();
    calculateStatistics();
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
    selectedRating = 0;
    document.getElementById('reviewText').value = '';
    document.getElementById('reviewMaster').value = '';
    updateStarsDisplay();
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    closeModal('reviewModal');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–∑—ã–≤—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
    loadRecentReviews();
    
    showNotification('–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–∑—ã–≤!', 'success');
}

function loadRecentReviews() {
    const container = document.getElementById('recentReviews');
    if (!container) return;
    
    const recent = allReviews.slice(0, 3);
    
    if (recent.length === 0) {
        container.innerHTML = `
            <div style="text-align:center;padding:20px;">
                <div style="font-size:48px;color:var(--text-muted);margin-bottom:20px;">‚≠ê</div>
                <p style="color:var(--text-muted);">–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>
                <button class="btn btn-primary" onclick="openReviewModal()" style="margin-top:20px;padding:10px 20px;">
                    <i class="fas fa-plus"></i> –û—Å—Ç–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –æ—Ç–∑—ã–≤
                </button>
            </div>
        `;
        return;
    }
    
    container.innerHTML = recent.map(review => `
        <div class="card" style="margin-bottom:15px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                <div style="font-weight:600;">${review.userName}</div>
                <div style="font-size:12px;color:var(--text-muted);">${formatDate(review.date, true)}</div>
            </div>
            <div style="display:flex;align-items:center;gap:5px;margin-bottom:10px;">
                ${'‚òÖ'.repeat(review.rating)}${'‚òÜ'.repeat(5 - review.rating)}
                <span style="font-size:14px;color:var(--text-muted);">${review.rating}.0</span>
            </div>
            <div style="font-size:14px;color:var(--text-primary);">
                ${review.text}
            </div>
            ${review.master ? `
                <div style="margin-top:10px;font-size:12px;color:var(--text-muted);">
                    –ú–∞—Å—Ç–µ—Ä: ${review.master}
                </div>
            ` : ''}
        </div>
    `).join('');
}

function loadAllReviews() {
    const container = document.getElementById('allReviews');
    if (!container) return;
    
    if (allReviews.length === 0) {
        container.innerHTML = `
            <div style="text-align:center;padding:40px;">
                <div style="font-size:48px;color:var(--text-muted);margin-bottom:20px;">‚≠ê</div>
                <p style="color:var(--text-muted);">–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>
                <button class="btn btn-primary" onclick="openReviewModal()" style="margin-top:20px;">
                    <i class="fas fa-plus"></i> –û—Å—Ç–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –æ—Ç–∑—ã–≤
                </button>
            </div>
        `;
        return;
    }
    
    container.innerHTML = allReviews.map(review => `
        <div class="card" style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
                <div>
                    <div style="font-weight:600;font-size:18px;">${review.userName}</div>
                    <div style="display:flex;align-items:center;gap:5px;margin-top:5px;">
                        ${'‚òÖ'.repeat(review.rating)}${'‚òÜ'.repeat(5 - review.rating)}
                        <span style="font-size:14px;color:var(--text-muted);">${review.rating}.0</span>
                    </div>
                </div>
                <div style="text-align:right;">
                    <div style="font-size:12px;color:var(--text-muted);">${formatDate(review.date, true)}</div>
                    ${review.master ? `
                        <div style="font-size:11px;color:var(--accent-primary);margin-top:5px;">
                            –ú–∞—Å—Ç–µ—Ä: ${review.master}
                        </div>
                    ` : ''}
                </div>
            </div>
            
            <div style="font-size:15px;color:var(--text-primary);margin-bottom:15px;line-height:1.5;">
                ${review.text}
            </div>
            
            <div style="display:flex;justify-content:space-between;align-items:center;font-size:12px;color:var(--text-muted);">
                <button class="btn-icon" onclick="likeReview(${review.id})" style="width:30px;height:30px;font-size:14px;">
                    <i class="fas fa-heart"></i> ${review.likes || 0}
                </button>
                <button class="btn btn-secondary" onclick="showReplyForm(${review.id})" style="padding:5px 15px;font-size:12px;">
                    –û—Ç–≤–µ—Ç–∏—Ç—å
                </button>
            </div>
            
            ${review.replies && review.replies.length > 0 ? `
                <div style="margin-top:15px;padding-top:15px;border-top:1px solid rgba(255,182,193,0.2);">
                    <div style="font-weight:600;margin-bottom:10px;font-size:14px;">–û—Ç–≤–µ—Ç—ã –º–∞—Å—Ç–µ—Ä–∞:</div>
                    ${review.replies.map(reply => `
                        <div style="background:rgba(255,182,193,0.1);padding:10px;border-radius:10px;margin-bottom:5px;">
                            <div style="display:flex;justify-content:space-between;font-size:12px;">
                                <span style="font-weight:600;color:var(--accent-primary);">–ú–∞—Å—Ç–µ—Ä</span>
                                <span style="color:var(--text-muted);">${formatDate(reply.date, true)}</span>
                            </div>
                            <div style="font-size:13px;margin-top:5px;">${reply.text}</div>
                        </div>
                    `).join('')}
                </div>
            ` : ''}
        </div>
    `).join('');
}

function likeReview(reviewId) {
    const review = allReviews.find(r => r.id === reviewId);
    if (review) {
        review.likes = (review.likes || 0) + 1;
        saveLocalData();
        loadAllReviews();
    }
}

function showReplyForm(reviewId) {
    const reply = prompt('–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç –º–∞—Å—Ç–µ—Ä–∞:');
    if (reply && reply.trim()) {
        const review = allReviews.find(r => r.id === reviewId);
        if (review) {
            if (!review.replies) review.replies = [];
            review.replies.push({
                id: Date.now(),
                text: reply.trim(),
                date: new Date().toISOString(),
                master: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'
            });
            saveLocalData();
            loadAllReviews();
            showNotification('–û—Ç–≤–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω', 'success');
        }
    }
}

// ================= –°–¢–ê–¢–ò–°–¢–ò–ö–ê =================
function calculateStatistics() {
    // –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞
    statistics.revenue = allBookings.reduce((sum, booking) => {
        if (booking.status === 'completed') {
            return sum + booking.price;
        }
        return sum;
    }, 0);
    
    // –í—Å–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏–π
    statistics.visits = allBookings.filter(b => b.status === 'completed').length;
    
    // –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥
    if (allReviews.length > 0) {
        const totalRating = allReviews.reduce((sum, review) => sum + review.rating, 0);
        statistics.avgRating = (totalRating / allReviews.length).toFixed(1);
    } else {
        statistics.avgRating = 0;
    }
    
    // –í—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤
    statistics.totalReviews = allReviews.length;
    
    // –í—ã—Ä—É—á–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º
    statistics.monthlyRevenue = {};
    allBookings.forEach(booking => {
        if (booking.status === 'completed') {
            const date = new Date(booking.date);
            const monthYear = `${date.getFullYear()}-${date.getMonth() + 1}`;
            statistics.monthlyRevenue[monthYear] = (statistics.monthlyRevenue[monthYear] || 0) + booking.price;
        }
    });
    
    // –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏
    statistics.popularServices = {};
    allBookings.forEach(booking => {
        statistics.popularServices[booking.service] = (statistics.popularServices[booking.service] || 0) + 1;
    });
    
    updateStatisticsUI();
}

function updateStatisticsUI() {
    document.getElementById('totalRevenue').textContent = statistics.revenue + ' ‚ÇΩ';
    document.getElementById('totalVisits').textContent = statistics.visits;
    document.getElementById('avgRating').textContent = statistics.avgRating;
    document.getElementById('totalReviews').textContent = statistics.totalReviews;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫
    updateRevenueChart();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏
    updatePopularServices();
}

function updateRevenueChart() {
    const container = document.getElementById('revenueChart');
    if (!container) return;
    
    const months = Object.keys(statistics.monthlyRevenue);
    if (months.length === 0) {
        container.innerHTML = '<div style="text-align:center;padding-top:80px;color:var(--text-muted);">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
        return;
    }
    
    const values = Object.values(statistics.monthlyRevenue);
    const maxValue = Math.max(...values);
    
    const monthNames = ['–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω', '–ò—é–ª', '–ê–≤–≥', '–°–µ–Ω', '–û–∫—Ç', '–ù–æ—è', '–î–µ–∫'];
    
    container.innerHTML = months.map((month, index) => {
        const [year, monthNum] = month.split('-');
        const height = (values[index] / maxValue) * 150;
        return `
            <div style="display:flex;flex-direction:column;align-items:center;gap:5px;">
                <div style="width:30px;height:${height}px;background:linear-gradient(to top, var(--accent-primary), var(--accent-secondary));border-radius:5px;"></div>
                <div style="font-size:11px;color:var(--text-muted);">${monthNames[monthNum - 1]}</div>
                <div style="font-size:10px;color:var(--accent-primary);font-weight:600;">${values[index]}‚ÇΩ</div>
            </div>
        `;
    }).join('');
}

function updatePopularServices() {
    const container = document.getElementById('popularServices');
    if (!container) return;
    
    const services = Object.entries(statistics.popularServices)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
    
    if (services.length === 0) {
        container.innerHTML = '<div style="text-align:center;padding:20px;color:var(--text-muted);">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
        return;
    }
    
    container.innerHTML = services.map(([service, count]) => `
        <div style="display:flex;justify-content:space-between;align-items:center;padding:10px;background:var(--bg-secondary);border-radius:10px;margin-bottom:10px;">
            <div style="font-weight:600;">${service}</div>
            <div style="display:flex;align-items:center;gap:10px;">
                <span style="color:var(--accent-primary);font-weight:600;">${count}</span>
                <span style="font-size:12px;color:var(--text-muted);">–∑–∞–ø–∏—Å–µ–π</span>
            </div>
        </div>
    `).join('');
}

// ================= –ß–ê–¢ =================
function loadChat() {
    const container = document.getElementById('chatMessages');
    
    // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π, –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ
    if (chatMessages.length === 0) {
        chatMessages = [
            {
                id: 1,
                text: '–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –Ø –≤–∞—à –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?',
                sender: 'master',
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            }
        ];
    }
    
    container.innerHTML = chatMessages.map(msg => `
        <div class="chat-message ${msg.sender}">
            <div style="margin-bottom:5px;">${msg.text}</div>
            <div style="font-size:11px;text-align:right;opacity:0.7;">${msg.time}</div>
        </div>
    `).join('');
    
    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
    container.scrollTop = container.scrollHeight;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
    updateChatStatus();
}

function updateChatStatus() {
    const status = document.getElementById('chatStatus');
    if (status) {
        const isOnline = Math.random() > 0.3; // 70% —à–∞–Ω—Å —á—Ç–æ –æ–Ω–ª–∞–π–Ω
        if (isOnline) {
            status.innerHTML = '<i class="fas fa-circle" style="font-size:8px;color:var(--accent-success);"></i> –ú–∞—Å—Ç–µ—Ä –æ–Ω–ª–∞–π–Ω';
        } else {
            status.innerHTML = '<i class="fas fa-circle" style="font-size:8px;color:var(--accent-warning);"></i> –û—Ç–≤–µ—Ç–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞';
        }
    }
}

function sendMessage() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const userMessage = {
        id: Date.now(),
        text: message,
        sender: 'user',
        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
    };
    
    chatMessages.push(userMessage);
    
    // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
    input.value = '';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —á–∞—Ç
    loadChat();
    
    // –ò–º–∏—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –º–∞—Å—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ 1-3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        const responses = [
            '–ü–æ–Ω—è–ª–∞ –≤–∞—Å! –ó–∞–ø–∏—à—É –Ω–∞ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è.',
            '–û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏!',
            '–£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∂–µ–ª–∞–µ–º—É—é –¥–∞—Ç—É.',
            '–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ! –ö–∞–∫–æ–π –¥–∏–∑–∞–π–Ω –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?',
            '–ú–∞—Å—Ç–µ—Ä –ê–Ω–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ç–∞–∫–∏—Ö –¥–∏–∑–∞–π–Ω–∞—Ö.',
            '–£ –Ω–∞—Å –µ—Å—Ç—å –∞–∫—Ü–∏—è –Ω–∞ —ç—Ç—É —É—Å–ª—É–≥—É –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ!',
            '–ü—Ä–µ–¥–æ–ø–ª–∞—Ç—É –º–æ–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –ø–æ —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º –≤ —Ä–∞–∑–¥–µ–ª–µ –∑–∞–ø–∏—Å–∏.',
            '–ù–∞ —ç—Ç–æ –≤—Ä–µ–º—è –µ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ –æ–∫–Ω–∞.'
        ];
        
        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
        
        const masterMessage = {
            id: Date.now() + 1,
            text: randomResponse,
            sender: 'master',
            time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
        };
        
        chatMessages.push(masterMessage);
        loadChat();
    }, 1000 + Math.random() * 2000);
}

function refreshChat() {
    loadChat();
    showNotification('–ß–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
}

// ================= –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =================
function addNotification(title, message, type = 'info') {
    const notification = {
        id: Date.now(),
        title,
        message,
        type,
        read: false,
        timestamp: new Date().toISOString()
    };
    
    notifications.unshift(notification);
    saveLocalData();
    updateNotificationBadge();
}

function showNotification(message, type = 'info', duration = 5000) {
    const container = document.getElementById('notificationContainer');
    const id = 'notification-' + Date.now();
    
    const notification = document.createElement('div');
    notification.id = id;
    notification.className = `notification ${type}`;
    notification.innerHTML = `
        <div style="font-size:20px;">
            ${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}
        </div>
        <div style="flex:1;">
            <div style="font-weight:600;">${type === 'success' ? '–£—Å–ø–µ—à–Ω–æ!' : type === 'error' ? '–û—à–∏–±–∫–∞!' : '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}</div>
            <div style="font-size:14px;margin-top:5px;">${message}</div>
        </div>
        <button class="notification-close" onclick="document.getElementById('${id}').remove()">&times;</button>
    `;
    
    container.appendChild(notification);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
    setTimeout(() => {
        if (document.getElementById(id)) {
            document.getElementById(id).remove();
        }
    }, duration);
}

function updateNotificationBadge() {
    const badge = document.getElementById('notificationBadge');
    const unreadCount = notifications.filter(n => !n.read).length;
    
    if (unreadCount > 0) {
        badge.textContent = unreadCount > 9 ? '9+' : unreadCount;
        badge.style.display = 'flex';
    } else {
        badge.style.display = 'none';
    }
}

// ================= –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–ò–í–ù–ê–Ø –ü–ê–ù–ï–õ–¨ =================
function loginAdmin() {
    const password = document.getElementById('adminPassword').value;
    
    if (password === CONFIG.MASTER_PASSWORD) {
        closeModal('adminModal');
        showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞', 'success');
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        setTimeout(() => {
            const adminMenu = `
                <div class="card">
                    <h3 class="section-title">‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin:20px 0;">
                        <button class="btn btn-primary" onclick="openStatisticsModal()">
                            <i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                        </button>
                        <button class="btn btn-danger" onclick="openBlacklistModal()">
                            <i class="fas fa-ban"></i> –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
                        </button>
                        <button class="btn btn-warning" onclick="showAllBookings()">
                            <i class="fas fa-calendar"></i> –í—Å–µ –∑–∞–ø–∏—Å–∏
                        </button>
                        <button class="btn btn-success" onclick="exportData()">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                    </div>
                </div>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –º–µ–Ω—é –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
            const mainScreen = document.getElementById('mainScreen');
            const existingAdminMenu = mainScreen.querySelector('.admin-menu');
            if (existingAdminMenu) {
                existingAdminMenu.remove();
            }
            
            const menuDiv = document.createElement('div');
            menuDiv.className = 'admin-menu';
            menuDiv.innerHTML = adminMenu;
            mainScreen.appendChild(menuDiv);
        }, 500);
        
    } else {
        showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å', 'error');
    }
}

function showAllBookings() {
    // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ –≤—Å–µ–º–∏ –∑–∞–ø–∏—Å—è–º–∏
    const modal = document.createElement('div');
    modal.className = 'modal-overlay';
    modal.style.display = 'flex';
    modal.innerHTML = `
        <div class="modal">
            <button class="modal-close" onclick="this.parentElement.parentElement.remove()">&times;</button>
            <h3 class="section-title">üìã –í—Å–µ –∑–∞–ø–∏—Å–∏</h3>
            <div style="max-height:400px;overflow-y:auto;">
                ${allBookings.map(booking => `
                    <div class="card" style="margin-bottom:10px;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                            <div>
                                <div style="font-weight:600;">${booking.service}</div>
                                <div style="font-size:12px;color:var(--text-muted);">${booking.userName}</div>
                            </div>
                            <div>
                                <span class="status-badge status-${booking.status}">
                                    ${booking.status === 'confirmed' ? '‚úÖ' : 
                                      booking.status === 'completed' ? '‚úÖ' : 
                                      booking.status === 'cancelled' ? '‚ùå' : '‚è≥'}
                                </span>
                            </div>
                        </div>
                        <div style="font-size:12px;color:var(--text-muted);">
                            üìÖ ${formatDate(booking.date)} üïê ${booking.time}<br>
                            üìû ${booking.phone} ‚Ä¢ üíµ ${booking.price}‚ÇΩ
                            ${booking.prepayment ? ' ‚Ä¢ üí≥ –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞' : ''}
                        </div>
                        <div style="display:flex;gap:5px;margin-top:10px;">
                            <button class="btn btn-success" onclick="changeBookingStatus(${booking.id}, 'completed')" style="padding:5px 10px;font-size:12px;">
                                –ó–∞–≤–µ—Ä—à–∏—Ç—å
                            </button>
                            <button class="btn btn-danger" onclick="changeBookingStatus(${booking.id}, 'cancelled')" style="padding:5px 10px;font-size:12px;">
                                –û—Ç–º–µ–Ω–∏—Ç—å
                            </button>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
}

function changeBookingStatus(bookingId, newStatus) {
    const booking = allBookings.find(b => b.id === bookingId);
    if (booking) {
        booking.status = newStatus;
        saveLocalData();
        calculateStatistics();
        showNotification(`–°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${newStatus}`, 'success');
        document.querySelector('.modal-overlay').remove();
        showAllBookings();
    }
}

// ================= –£–¢–ò–õ–ò–¢–´ =================
function loadLocalData() {
    try {
        allBookings = JSON.parse(localStorage.getItem('nailSakuraBookings') || '[]');
        allReviews = JSON.parse(localStorage.getItem('nailSakuraReviews') || '[]');
        notifications = JSON.parse(localStorage.getItem('nailSakuraNotifications') || '[]');
        blacklist = JSON.parse(localStorage.getItem('nailSakuraBlacklist') || '[]');
        chatMessages = JSON.parse(localStorage.getItem('nailSakuraChat') || '[]');
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
    }
}

function saveLocalData() {
    try {
        localStorage.setItem('nailSakuraBookings', JSON.stringify(allBookings));
        localStorage.setItem('nailSakuraReviews', JSON.stringify(allReviews));
        localStorage.setItem('nailSakuraNotifications', JSON.stringify(notifications));
        localStorage.setItem('nailSakuraBlacklist', JSON.stringify(blacklist));
        localStorage.setItem('nailSakuraChat', JSON.stringify(chatMessages));
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
    }
}

function formatDate(dateString, includeTime = false) {
    const date = new Date(dateString);
    const options = { day: 'numeric', month: 'long', year: 'numeric' };
    const formatted = date.toLocaleDateString('ru-RU', options);
    
    if (includeTime) {
        const time = date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
        return `${formatted} ${time}`;
    }
    
    return formatted;
}

function showLoader() {
    document.getElementById('loader').classList.remove('hidden');
}

function hideLoader() {
    document.getElementById('loader').classList.add('hidden');
}

function setTheme(theme) {
    currentTheme = theme;
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('nailSakuraTheme', theme);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
    document.querySelector('.theme-toggle').setAttribute('data-theme', theme);
}

function openThemeModal() {
    showModal('themeModal');
}

function openReviewModal() {
    showModal('reviewModal');
    setupRatingStars();
}

function openStatisticsModal() {
    calculateStatistics();
    showModal('statisticsModal');
}

function openBlacklistModal() {
    updateBlacklist();
    showModal('blacklistModal');
}

function openAdminModal() {
    showModal('adminModal');
}

function openPaymentModal() {
    showModal('paymentModal');
}

function showModal(modalId) {
    document.getElementById(modalId).classList.remove('hidden');
}

function closeModal(modalId) {
    document.getElementById(modalId).classList.add('hidden');
}

function createParticles() {
    const container = document.getElementById('particles');
    const emojis = ['üå∏', '‚ú®', 'üíÖ', 'üé®', 'üíé', 'üíñ', '‚≠ê', 'üéÄ'];
    
    for (let i = 0; i < 15; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
        particle.style.left = Math.random() * 100 + 'vw';
        particle.style.top = Math.random() * 100 + 'vh';
        particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
        particle.style.opacity = Math.random() * 0.3 + 0.1;
        particle.style.transform = `scale(${Math.random() * 0.5 + 0.5})`;
        container.appendChild(particle);
    }
}

function updateUI() {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if (currentUser) {
        document.getElementById('userName').textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentUser.firstName}!`;
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
    updateUpcomingBookings();
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤
    loadRecentReviews();
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–π–¥–∂–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    updateNotificationBadge();
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É
    const today = new Date().toISOString().split('T')[0];
    const dateInput = document.getElementById('bookingDate');
    if (dateInput) {
        dateInput.min = today;
        dateInput.value = today;
    }
}

function updateUpcomingBookings() {
    const container = document.getElementById('upcomingBookings');
    if (!container) return;
    
    const today = new Date().toISOString().split('T')[0];
    const upcoming = allBookings
        .filter(b => b.userId === currentUser.id && b.date >= today && b.status !== 'cancelled')
        .sort((a, b) => new Date(a.date) - new Date(b.date))
        .slice(0, 3);
    
    if (upcoming.length === 0) {
        container.innerHTML = `
            <div style="text-align:center;padding:20px;">
                <div style="font-size:48px;color:var(--text-muted);margin-bottom:20px;">üìÖ</div>
                <p style="color:var(--text-muted);">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π</p>
                <button class="btn btn-primary" onclick="showScreen('booking')" style="margin-top:20px;padding:10px 20px;">
                    <i class="fas fa-calendar-plus"></i> –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
                </button>
            </div>
        `;
        return;
    }
    
    container.innerHTML = upcoming.map(booking => `
        <div class="card" style="margin-bottom:10px;padding:15px;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <div>
                    <div style="font-weight:600;margin-bottom:5px;">${booking.service}</div>
                    <div style="font-size:12px;color:var(--text-muted);">
                        üìÖ ${formatDate(booking.date)} üïê ${booking.time}
                    </div>
                </div>
                <span class="status-badge status-${booking.status}">
                    ${booking.status === 'confirmed' ? '‚úÖ' : 
                      booking.status === 'completed' ? '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ' : '‚è≥'}
                </span>
            </div>
            <div style="margin-top:10px;font-size:12px;color:var(--text-muted);">
                üíµ ${booking.price}‚ÇΩ ‚Ä¢ üìû ${booking.phone}
                ${booking.prepayment ? ' ‚Ä¢ üí≥ –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞' : ''}
            </div>
        </div>
    `).join('');
}

function loadUserBookings() {
    const container = document.getElementById('bookingsList');
    if (!container) return;
    
    const userBookings = allBookings.filter(b => b.userId === currentUser.id);
    
    if (userBookings.length === 0) {
        container.innerHTML = `
            <div style="text-align:center;padding:40px;">
                <div style="font-size:48px;color:var(--text-muted);margin-bottom:20px;">üìÖ</div>
                <p style="color:var(--text-muted);margin-bottom:20px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π</p>
                <button class="btn btn-primary" onclick="showScreen('booking')">
                    <i class="fas fa-calendar-plus"></i> –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
                </button>
            </div>
        `;
        return;
    }
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ
    const sorted = userBookings.sort((a, b) => new Date(b.date) - new Date(a.date));
    
    container.innerHTML = sorted.map(booking => `
        <div class="card" style="margin-bottom:15px;">
            <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:15px;">
                <div>
                    <div style="font-weight:600;font-size:18px;margin-bottom:5px;">${booking.service}</div>
                    <div style="font-size:14px;color:var(--text-muted);">
                        üìÖ ${formatDate(booking.date)} üïê ${booking.time}
                    </div>
                </div>
                <span class="status-badge status-${booking.status}">
                    ${booking.status === 'confirmed' ? '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' : 
                      booking.status === 'completed' ? '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ' : 
                      booking.status === 'cancelled' ? '‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ' : '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ'}
                </span>
            </div>
            
            <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin:15px 0;font-size:14px;">
                <div>
                    <div style="color:var(--text-muted);">–ú–∞—Å—Ç–µ—Ä:</div>
                    <div style="font-weight:600;">${booking.master || '–ù–µ —É–∫–∞–∑–∞–Ω'}</div>
                </div>
                <div>
                    <div style="color:var(--text-muted);">–°—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                    <div style="font-weight:600;color:var(--accent-primary);">${booking.price}‚ÇΩ</div>
                </div>
            </div>
            
            <div style="font-size:12px;color:var(--text-muted);margin-top:10px;">
                üìû ${booking.phone}
                ${booking.prepayment ? ' ‚Ä¢ üí≥ –° –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–æ–π' : ''}
                ${booking.prepaymentPaid ? ' (–æ–ø–ª–∞—á–µ–Ω–æ)' : ''}
            </div>
            
            <div style="display:flex;gap:10px;margin-top:15px;">
                <button class="btn btn-secondary" onclick="cancelBooking(${booking.id})" style="flex:1;padding:10px;font-size:14px;" ${booking.status === 'cancelled' || booking.status === 'completed' ? 'disabled' : ''}>
                    <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∏—Ç—å
                </button>
                ${booking.prepayment && !booking.prepaymentPaid ? `
                    <button class="btn btn-warning" onclick="openPaymentModal()" style="flex:1;padding:10px;font-size:14px;">
                        <i class="fas fa-credit-card"></i> –û–ø–ª–∞—Ç–∏—Ç—å
                    </button>
                ` : ''}
            </div>
        </div>
    `).join('');
}

function cancelBooking(bookingId) {
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å?')) {
        const booking = allBookings.find(b => b.id === bookingId);
        if (booking) {
            booking.status = 'cancelled';
            saveLocalData();
            loadUserBookings();
            updateUpcomingBookings();
            showNotification('–ó–∞–ø–∏—Å—å –æ—Ç–º–µ–Ω–µ–Ω–∞', 'success');
        }
    }
}

function refreshBookings() {
    loadUserBookings();
    showNotification('–°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
}

function selectService(type) {
    const services = {
        'manicure': '–ú–∞–Ω–∏–∫—é—Ä|1500',
        'gel': '–ì–µ–ª—å-–ª–∞–∫|2000',
        'design': '–î–∏–∑–∞–π–Ω|1000',
        'spa': 'SPA-—É—Ö–æ–¥|1800'
    };
    
    if (services[type]) {
        document.getElementById('serviceSelect').value = services[type];
        showScreen('booking');
    }
}

function filterBookings(filter) {
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
    document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    loadUserBookings();
}

function exportData() {
    const data = {
        app: CONFIG.APP_NAME,
        version: CONFIG.VERSION,
        exportDate: new Date().toISOString(),
        statistics: statistics,
        bookings: allBookings,
        reviews: allReviews,
        blacklist: blacklist,
        user: currentUser
    };
    
    const json = JSON.stringify(data, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `nail_sakura_data_${new Date().toISOString().split('T')[0]}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    showNotification('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ JSON', 'success');
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
function setupEventListeners() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤–µ–∑–¥ —Ä–µ–π—Ç–∏–Ω–≥–∞
    setupRatingStars();
}

// –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
window.onload = function() {
    console.log('üå∏ Nail Sakura Studio initialized');
};
</script>
</body>
</html>
